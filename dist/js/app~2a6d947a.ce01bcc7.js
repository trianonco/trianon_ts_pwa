(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app~2a6d947a"],{c7e5:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("ac6a"),n("7514"),n("a481"),n("96cf");var r=n("3b8d"),a=n("d225"),c=n("b0b4"),i=n("59ca"),o=n.n(i),u=n("bc3a"),s=n.n(u),p=function(){function e(){Object(a["a"])(this,e),this.db=o.a.firestore(),this.db_collection="SETTINGS",this.db_docs={HOME_SETTINGS:{TITLE:"HOME_TITLE",SWIPER:"HOME_SWIPER",BANNERS:"HOME_BANNERS"},SHOP_SETTINGS:{CATEGORIES:"SHOP_CATEGORIES",GENDER:"SHOP_GENDER"},AUTHORIZED_DISTRIBUTORS_AND_SHOPS_SETTINGS:{DISTRIBUTORS:"AUTHORIZED_DISTRIBUTORS",SHOPS:"AUTHORIZED_SHOPS"}}}return Object(c["a"])(e,[{key:"init",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log(" .... Initing DB ");case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getTitle",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n,r){var a,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a="HOME_SETTINGS",c=t.db.collection(t.db_collection),c.doc(a).get().then(function(e){if(e.exists){var a=e.data(),c=a[t.db_docs.HOME_SETTINGS.TITLE],i=c;n(i)}else r("No such document!")}).catch(function(e){r(e)});case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"setTitle",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(r,a){var c,i,o,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:c="HOME_SETTINGS",i=n.db.collection(n.db_collection),o=n.db_docs.HOME_SETTINGS.TITLE,u={},u[o]=t,i.doc(c).update(u).then(function(e){r(e)}).catch(function(e){a(e)});case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSwiperSlides",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n,r){var a,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a="HOME_SETTINGS",c=t.db.collection(t.db_collection),c.doc(a).get().then(function(e){if(e.exists){var a=e.data(),c=a[t.db_docs.HOME_SETTINGS.SWIPER],i="string"===typeof c?JSON.parse(c+""):c,o=i;n(o)}else r("No such document!")}).catch(function(e){r(e)});case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"setSwiperSlides",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(r,a){var c,i,o,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:c="HOME_SETTINGS",i=n.db.collection(n.db_collection),o=n.db_docs.HOME_SETTINGS.SWIPER,u={},u[o]=JSON.stringify(t),i.doc(c).update(u).then(function(e){r(e)}).catch(function(e){a(e)});case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getShopCategories",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n,r){var a,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a="SHOP_SETTINGS",c=t.db.collection(t.db_collection),c.doc(a).get().then(function(e){if(e.exists){var a=e.data(),c=a[t.db_docs.SHOP_SETTINGS.CATEGORIES],i="string"===typeof c?JSON.parse(c+""):c,o=i;n(o)}else r("No such document!")}).catch(function(e){r(e)});case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"setShopCategories",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(r,a){var c,i,o,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:c="SHOP_SETTINGS",i=n.db.collection(n.db_collection),o=n.db_docs.SHOP_SETTINGS.CATEGORIES,u={},u[o]=JSON.stringify(t),i.doc(c).update(u).then(function(e){console.warn("shopCategories"),console.warn(t),r(e)}).catch(function(e){a(e)});case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getAuthorizedDistributors",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n,r){var a,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a="DISTRIBUTORS_AND_SHOPS",c=t.db.collection(t.db_collection),c.doc(a).get().then(function(e){if(e.exists){var a=e.data(),c=a[t.db_docs.AUTHORIZED_DISTRIBUTORS_AND_SHOPS_SETTINGS.DISTRIBUTORS],i="string"===typeof c?JSON.parse(c+""):c,o=i;n(o)}else r("No such document!")}).catch(function(e){r(e)});case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getLatLngFromAddress",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(r,c){var i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:"https://maps.googleapis.com/maps/api/geocode/json?","AIzaSyDIwlZ8kuzsE9T0_1OMhN6GoeQYXT7pvus",i=encodeURI("".concat(t,",").concat(n," ,").concat(a).replace("-"," - ")).replace("#","%23").replace("CR","Carrera").replace("CL","Calle"),o="https://maps.googleapis.com/maps/api/geocode/json?address="+i+"&key=AIzaSyDIwlZ8kuzsE9T0_1OMhN6GoeQYXT7pvus",s.a.get(o).then(function(e){if(e&&e.data)try{var t=e.data.results,n=t[0],a=n.geometry,c=a.location;r(c)}catch(i){r()}else r()}).catch(function(e){r()});case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"getAuthorizedShops",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n,r){var a,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a="DISTRIBUTORS_AND_SHOPS",c=t.db.collection(t.db_collection),c.doc(a).get().then(function(e){if(e.exists){var a=e.data(),c=a[t.db_docs.AUTHORIZED_DISTRIBUTORS_AND_SHOPS_SETTINGS.SHOPS],i="string"===typeof c?JSON.parse(c+""):c,o=i;n(o)}else r("No such document!")}).catch(function(e){r(e)});case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"setAuthorizedShops",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(a,c){var i,o,u,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i="DISTRIBUTORS_AND_SHOPS",o=n.db_docs.AUTHORIZED_DISTRIBUTORS_AND_SHOPS_SETTINGS.SHOPS,u=n.db.collection(n.db_collection),s={},n.getAuthorizedShops().then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(p){var f,l,d,h,S,g,m,w,O;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:f=JSON.parse(JSON.stringify(p)+""),l=[],console.log(" (shopsOnDB: any)  "),f.map(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n){var r,a,c,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=JSON.parse(JSON.stringify(t.find(function(e){return e.place===n["place"]}))+""),a=JSON.parse(JSON.stringify(n)+""),c=a["createdAt"]||new Date,i=a["updatedAt"]||new Date,r!==a?(r["updatedAt"]=new Date,r["createdAt"]=c):(r["updatedAt"]=i,r["createdAt"]=c),l.push(r),e.abrupt("return",r);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),console.warn(" ----------------------------- "),console.warn("a_distributorsOnDB"),console.warn(l),console.warn(" ----------------------------- "),d=[],h=[],S=0;case 11:if(!(S<l.length)){e.next=23;break}return g=l[S].address||l[S].place,m=l[S].city,w=l[S].department,e.next=17,n.getLatLngFromAddress(g,m,w);case 17:O=e.sent,O?(d.push({city:m,address:g,position:O}),l[S]["coord"]={lat:O.lat,lng:O.lng}):h.push({city:m,address:g}),console.log(S/l.length*100);case 20:S++,e.next=11;break;case 23:localStorage.setItem("okPosition_shop",JSON.stringify(d)),localStorage.setItem("noPosition_shop",JSON.stringify(h)),s[o]=JSON.stringify(l),u.doc(i).update(s).then(function(e){a(e)}).catch(function(e){c(e)});case 27:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"setAuthorizedDistributors",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(a,c){var i,o,u,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i="DISTRIBUTORS_AND_SHOPS",o=n.db_docs.AUTHORIZED_DISTRIBUTORS_AND_SHOPS_SETTINGS.DISTRIBUTORS,u=n.db.collection(n.db_collection),s={},n.getAuthorizedDistributors().then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(r){var p,f,l,d,h,S,g,m,w;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:p=JSON.parse(JSON.stringify(r)+""),f=JSON.parse(JSON.stringify(t)+""),l=[],d=[],h=[],S=regeneratorRuntime.mark(function e(t){var r,a,c,i,o,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=f[t],a=p.find(function(e){return e.code.replace(/\s/g,"")==r.code.replace(/\s/g,"")}),c=r.address,i=r.city,o=r.department,e.next=7,n.getLatLngFromAddress(c,i,o);case 7:u=e.sent,r["position"]=u||{},a?(r["updatedAt"]=new Date,d.push(r)):(r["createdAt"]=new Date,l.push(r));case 10:case"end":return e.stop()}},e)}),g=0;case 7:if(!(g<f.length)){e.next=12;break}return e.delegateYield(S(g),"t0",9);case 9:g++,e.next=7;break;case 12:p.map(function(e,t){var n=e,r=f.find(function(e){return e.code.replace(/\s/g,"")==n.code.replace(/\s/g,"")});r||h.push(n)}),m=[].concat(l,d),w=JSON.stringify(m),s[o]=w,u.doc(i).update(s).then(function(e){a(e)}).catch(function(e){c(e)});case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}()}}]);